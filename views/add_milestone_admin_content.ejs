<h2 class="mb-4">Add Milestone (Admin)</h2>

<form action="/milestone/add_admin" method="POST">

    <!-- Participant ID -->
    <div class="mb-3">
        <label class="form-label">Selected Participant ID</label>
        <input type="text" id="participantID" name="Participant_ID" class="form-control" placeholder="Select a participant…" readonly required>
    </div>

    <!-- Title -->
    <div class="mb-3">
        <label class="form-label">Milestone Title</label>
        <input type="text" name="MilestoneTitle" class="form-control" required>
    </div>

    <!-- Date -->
    <div class="mb-3">
        <label class="form-label">Milestone Date</label>
        <input type="date" name="MilestoneDate" class="form-control" required>
    </div>

    <button class="custom-btn mt-3">Add Milestone</button>
    <a href="/manage_dashboard?view=milestones" class="btn btn-secondary ms-3">Cancel</a>

</form>

<hr class="my-4">

<h3>Select Participant</h3>

<div class="mb-3">
    <input type="text" id="searchInput" class="form-control" placeholder="Search participants…">
</div>

<div style="max-height: 350px; overflow-y: auto;">
    <table class="table table-striped" id="participantsTable">
        <thead>
            <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Email</th>
            </tr>
        </thead>
        <tbody>
            <% participants.forEach(p => { %>
                <tr onclick="chooseParticipant('<%= p.Participant_ID %>')" style="cursor:pointer;">
                    <td>
                        <%= p.Participant_ID %>
                    </td>
                    <td>
                        <%= p.ParticipantFirstName %>
                            <%= p.ParticipantLastName %>
                    </td>
                    <td>
                        <%= p.ParticipantEmail %>
                    </td>
                </tr>
                <% }) %>
        </tbody>
    </table>
</div>

<script>
    function chooseParticipant(id) {
        document.getElementById("participantID").value = id;
    }

    const searchInput = document.getElementById("searchInput");
    searchInput.addEventListener("input", function() {
        const filter = this.value.toLowerCase();
        const rows = document.querySelectorAll("#participantsTable tbody tr");

        rows.forEach(row => {
            row.style.display = row.innerText.toLowerCase().includes(filter) ? "" : "none";
        });
    });
</script>